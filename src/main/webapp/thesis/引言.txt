众所周知，随着高校的不断扩招，教学规模也随之扩大，相应的教学管理工作也变得日益繁琐，
特别是针对需求灵活的一些应用，简单的一成不变的固定表单技术已经不能满足工作上的需要，
因此，动态表单技术在教学管理中的需求就显得越来越迫切。 
　　在教学管理中，让管理人员头疼的问题，就是需求是不断变化的，特别是表单项的更改，
对于没有软件开发经验的管理人员来讲惟一能做的只有联系软件开发人员进行程序修改，
同时还要修改数据表，工作量会比较大，这样系统维护成本比较高。 
　　鉴于此，本文提出了基于XML的动态表单的实现技术，实现了数据和表单的分离，
方便表单重现和数据的存储，此外，还支持表单数据以Excel文件形式导出，方便办公人员的进一步操作。

二、总体设计 
　　1.系统总体思想 
　　考虑到办公人员需要对录入的数据进行进一步的分析统计，另外结合目前关系型数据库的数据操作方便性等特点，系统在设计时候考虑到了根据动态表单自动生成相应的数据表，这样最终录入的数据会自动存储在相应的数据表，最后可以利用SQL语句进行高效的数据操作。 
　　因此，系统在动态表单的存储上采用XML文件形式进行存储，动态表单所对应的用户提交数据采用关系型数据库进行存储。 
　　这样，系统就实现了数据和表单的分离，数据和表单的单独管理，同时也实现了在录入表单数据时的表单重现。 
　　2.系统总体流程 
　　本文所设计的系统，其总体运行流程如图1所示。 
　　首先是登录操作，根据权限判断，如果是管理员，那么可以选择表单设计或者表单操作。 
　　如果是表单设计，那么就进入到表单设计界面，设计完毕后会自动生成表单并以XML形式进行存储，同时会在关系型数据库中生成相应的数据表（用来存储用户提交表单的数据）。 
　　如果是表单操作，那么可以选择查看、删除和导出表单三项操作中的任何一项。如果是查看操作，则可以浏览用户提交表单的数据；如果是删除操作，则删除相应的表单，同时删除生成的相应数据表和数据；如果是导出操作，则将以Excel文件形式导出该表单相关的用户提交数据。 
　　如果是普通用户，那么就可以进行表单数据的录入操作，根据给定的表单选择进入后，系统会读取XML文件形式的表单进行重现，之后正常录入数据，直到提交表单结束操作。 
　　三、关键技术实现 
　　这里以学生考勤表单的动态设计在教学管理中的应用为例，阐述一些设计上的关键技术和细节。 
　　1.表单设计 
　　如图2所示，是一个表单设计的可视化界面。 
　　用户首先输入表单名，这里的表单名可以采用中英文（最后以该名称生成相应的数据表），接着输入表单文件名，即最后生成的XML形式表单文件的名称。 
　　接下去就是表单中的表单项设置，如图2所示，这里设计了一个学生考勤的表单，表单项包含学号、姓名、类型（迟到、早退和旷课）、节数（1节、2节、3节和4节）、备注。 
　　下拉列表里是相应的表单项类型，比如文本框、密码框、单选框、复选框和下拉列表等，在设计过程中，有选择性地设置对应的表单项类型。假设一般课程为1~4节，那么“节数”表单项这里就应该选择单选框。 
　　在技术实现上，考虑到交互操作的灵活性，这里采用JavaScript技术。当点击“增加表项”后会自动生成新的一行表项；点击“删除表项”后会删除当前表单项；当选择“单选/复选/下拉列表”时会有“增加属性”的子项。JavaScript技术可以使得交互操作非常灵活方便。 
　　2.表单和数据的存储 
　　为了实现表单和数据的分离，表单采用XML文件形式进行存储，根据前面学生考勤表单的设计，相应地会生成一个kaoqin.xml文件。 
　　在数据库中有两个固定的表，login表用来存储登录的账号，table表用来存储表单名称和相应的数据表名的关联记录。 
　　根据表单的设计，数据库中会生成一个学生考勤表，它是根据表单名称动态生成的数据表，表的字段结构和表单项一一对应，用来存储用户提交的表单数据。 
　　用户的表单提交数据及其存储情况，如图3所示。 
　　以上就是表单和数据的分离设计。 
　　3.表单重现 
　　表单重现，顾名思义，就是根据之前表单的定义，在使用中将表单重新展现给用户的一个过程。 
　　学生考勤表单的定义文件以kaoqin.xml形式存储，在表单重现过程中，系统首先读取XML文件，之后再根据读取的内容进行判断并显示。 
　　表单重现的总体过程如下： 
　　（１）读入ＸＭＬ文件，紧接着读取节点列表，之后再对节点列表中的一个个节点数据进行分析，即节点数据解析，节点数据解析分两种情况：“表单项含属性和不含属性”。前者比如单选框、复选框、下拉列表等表单项；后者就是一般的表单项处理。 
　　（２）对于不同的表单项，做出不同的解析处理，最后就可以实现表单的重现。 
　　如图4所示，是一个完整的学生考勤表单的重现，包含学号、姓名、类型、节数和备注，同时还有提交和重置按钮。 
　　作为演示，这里简单填写了一个表单数据，数据填写完毕后，点击提交按钮，完成数据录入操作，之后就可以在相应的数据表（学生考勤表）中看到刚刚录入的数据，如图3所示。 
　　4.表单数据导出 
　　在教学管理当中，经常性需要打印数据。比如对于学生考勤来讲，除了教师定期上报数据外，教学管理人员还需要打印并请相关人员签字备案。 
　　因此，系统也提供了表单数据导出的功能，结合Excel处理数据高效快捷等原因，最后，采用Excel文件形式导出表单数据。 
　　点击“导出”操作，表单数据导出，打开导出的Excel文件，如图5所示。 
　　四、结论 
　　本文设计并实现了一个通用的动态表单系统，通过学生考勤表单的动态设计及其在教学管理中的应用为例，证明了动态表单技术能很好地解决教学管理中一些实时需求问题，可以大大提高教学管理人员的工作效率。总之，在复杂多变的教学管理中，动态表单技术的应用必将发挥越来越重要的作用。 
　　参考文献： 
　　[1]张佳强,王士同.信息管理系统动态表单技术的研究与实现[J].计算机应用与软件,2010.27(8):29-32. 
　　[2]蒋国银,刘鹏远.基于XML的动态表单设计[J].中国管理信息化,2006.9(9):83-84. 
　　[3]刘友生.基于数据表的动态表单处理技术[J].计算机工程与应用,2004(34):199-201. 